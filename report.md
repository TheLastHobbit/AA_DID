# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#h-1-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256)
  - [H-2: Unprotected initializer](#h-2-unprotected-initializer)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk for trusted owners](#l-1-centralization-risk-for-trusted-owners)
  - [L-2: `ecrecover` is susceptible to signature malleability](#l-2-ecrecover-is-susceptible-to-signature-malleability)
  - [L-3: Solidity pragma should be specific, not wide](#l-3-solidity-pragma-should-be-specific-not-wide)
  - [L-4: Missing checks for `address(0)` when assigning values to address state variables](#l-4-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-5: `public` functions not used internally could be marked `external`](#l-5-public-functions-not-used-internally-could-be-marked-external)
  - [L-6: Define and use `constant` variables instead of using literals](#l-6-define-and-use-constant-variables-instead-of-using-literals)
  - [L-7: Empty `require()` / `revert()` statements](#l-7-empty-require--revert-statements)
  - [L-8: PUSH0 is not supported by all chains](#l-8-push0-is-not-supported-by-all-chains)
  - [L-9: Modifiers invoked only once can be shoe-horned into the function](#l-9-modifiers-invoked-only-once-can-be-shoe-horned-into-the-function)
  - [L-10: Empty Block](#l-10-empty-block)
  - [L-11: Internal functions called only once can be inlined](#l-11-internal-functions-called-only-once-can-be-inlined)
  - [L-12: Inconsistency in declaring uint256/uint (or) int256/int variables within a contract. Use explicit size declarations (uint256 or int256).](#l-12-inconsistency-in-declaring-uint256uint-or-int256int-variables-within-a-contract-use-explicit-size-declarations-uint256-or-int256)
  - [L-13: Loop contains `require`/`revert` statements](#l-13-loop-contains-requirerevert-statements)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 14 |
| Total nSLOC | 1272 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/Counter.sol | 10 |
| src/DKIM/contracts/Algorithm.sol | 97 |
| src/DKIM/contracts/InitialInterfaces.sol | 12 |
| src/DKIM/contracts/Multicall3.sol | 131 |
| src/DKIM/contracts/PluginRegistry.sol | 38 |
| src/DKIM/contracts/PublicKeyOracle.sol | 21 |
| src/DKIM/contracts/SocialRecovery.sol | 370 |
| src/DKIM/contracts/interfaces/IDKIMPublicKeyOracle.sol | 13 |
| src/DKIM/contracts/interfaces/ISocialRecovery.sol | 17 |
| src/DKIM/contracts/utils/Strings.sol | 412 |
| src/EntryPoint.sol | 5 |
| src/ZKtool.sol | 80 |
| src/wallet.sol | 1 |
| src/walletFactory.sol | 65 |
| **Total** | **1272** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 2 |
| Low | 13 |


# High Issues

## H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

<details><summary>2 Found Instances</summary>


- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 98](src/DKIM/contracts/SocialRecovery.sol#L98)

	```solidity
	        hexString = string(abi.encodePacked("0x", hexString));
	```

- Found in src/walletFactory.sol [Line: 32](src/walletFactory.sol#L32)

	```solidity
	                    abi.encodePacked(
	```

</details>



## H-2: Unprotected initializer

Consider protecting the initializer functions with modifiers.

<details><summary>2 Found Instances</summary>


- Found in src/Wallet.sol [Line: 94](src/wallet.sol#L94)

	```solidity
	    function _initialize(address anOwner) internal virtual {
	```

- Found in src/wallet.sol [Line: 94](src/wallet.sol#L94)

	```solidity
	    function _initialize(address anOwner) internal virtual {
	```

</details>



# Low Issues

## L-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>7 Found Instances</summary>


- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 7](src/DKIM/contracts/PluginRegistry.sol#L7)

	```solidity
	contract PluginRegistry is Ownable {
	```

- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 15](src/DKIM/contracts/PluginRegistry.sol#L15)

	```solidity
	    function implement(address account, bytes4[] calldata interfaceIds) external onlyOwner {
	```

- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 21](src/DKIM/contracts/PluginRegistry.sol#L21)

	```solidity
	    function removeMethod(bytes4 interfaceId) external onlyOwner {
	```

- Found in src/DKIM/contracts/PublicKeyOracle.sol [Line: 8](src/DKIM/contracts/PublicKeyOracle.sol#L8)

	```solidity
	contract PublicKeyOracle is Ownable, IDKIMPublicKeyOracle {
	```

- Found in src/DKIM/contracts/PublicKeyOracle.sol [Line: 19](src/DKIM/contracts/PublicKeyOracle.sol#L19)

	```solidity
	    function setPublicKey(string calldata domain, string calldata selector, bytes calldata modulus, bytes calldata exponent) external onlyOwner {
	```

- Found in src/Wallet.sol [Line: 244](src/wallet.sol#L244)

	```solidity
	    function setEmailCommitment(bytes memory _commitment) external onlyOwner {
	```

- Found in src/wallet.sol [Line: 244](src/wallet.sol#L244)

	```solidity
	    function setEmailCommitment(bytes memory _commitment) external onlyOwner {
	```

</details>



## L-2: `ecrecover` is susceptible to signature malleability

The `ecrecover` function is susceptible to signature malleability. This means that the same message can be signed in multiple ways, allowing an attacker to change the message signature without invalidating it. This can lead to unexpected behavior in smart contracts, such as the loss of funds or the ability to bypass access control. Consider using OpenZeppelin's ECDSA library instead of the built-in function.

<details><summary>2 Found Instances</summary>


- Found in src/Wallet.sol [Line: 264](src/wallet.sol#L264)

	```solidity
	        return ecrecover(hash, v, r, s);
	```

- Found in src/wallet.sol [Line: 264](src/wallet.sol#L264)

	```solidity
	        return ecrecover(hash, v, r, s);
	```

</details>



## L-3: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>15 Found Instances</summary>


- Found in src/Counter.sol [Line: 2](src/Counter.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 2](src/DKIM/contracts/Algorithm.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/InitialInterfaces.sol [Line: 2](src/DKIM/contracts/InitialInterfaces.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 2](src/DKIM/contracts/Multicall3.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 2](src/DKIM/contracts/PluginRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/PublicKeyOracle.sol [Line: 2](src/DKIM/contracts/PublicKeyOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 2](src/DKIM/contracts/SocialRecovery.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/interfaces/IDKIMPublicKeyOracle.sol [Line: 2](src/DKIM/contracts/interfaces/IDKIMPublicKeyOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/interfaces/ISocialRecovery.sol [Line: 2](src/DKIM/contracts/interfaces/ISocialRecovery.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 38](src/DKIM/contracts/utils/Strings.sol#L38)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/EntryPoint.sol [Line: 2](src/EntryPoint.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/Wallet.sol [Line: 2](src/wallet.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/ZKtool.sol [Line: 2](src/ZKtool.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/wallet.sol [Line: 2](src/wallet.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/walletFactory.sol [Line: 2](src/walletFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

</details>



## L-4: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

<details><summary>6 Found Instances</summary>


- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 13](src/DKIM/contracts/SocialRecovery.sol#L13)

	```solidity
	        oracle = IDKIMPublicKeyOracle(_oracle);
	```

- Found in src/Wallet.sol [Line: 89](src/wallet.sol#L89)

	```solidity
	        socialRecovery = ISocialRecovery(_socialRecovery);
	```

- Found in src/Wallet.sol [Line: 190](src/wallet.sol#L190)

	```solidity
	        socialRecovery = ISocialRecovery(_socialRecovery);
	```

- Found in src/wallet.sol [Line: 89](src/wallet.sol#L89)

	```solidity
	        socialRecovery = ISocialRecovery(_socialRecovery);
	```

- Found in src/wallet.sol [Line: 190](src/wallet.sol#L190)

	```solidity
	        socialRecovery = ISocialRecovery(_socialRecovery);
	```

- Found in src/walletFactory.sol [Line: 20](src/walletFactory.sol#L20)

	```solidity
	        dkim = _dkim;
	```

</details>



## L-5: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

<details><summary>35 Found Instances</summary>


- Found in src/Counter.sol [Line: 7](src/Counter.sol#L7)

	```solidity
	    function setNumber(uint256 newNumber) public {
	```

- Found in src/Counter.sol [Line: 11](src/Counter.sol#L11)

	```solidity
	    function increment() public {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 41](src/DKIM/contracts/Multicall3.sol#L41)

	```solidity
	    function aggregate(Call[] calldata calls) public payable returns (uint256 blockNumber, bytes[] memory returnData) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 91](src/DKIM/contracts/Multicall3.sol#L91)

	```solidity
	    function blockAndAggregate(Call[] calldata calls) public payable returns (uint256 blockNumber, bytes32 blockHash, Result[] memory returnData) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 98](src/DKIM/contracts/Multicall3.sol#L98)

	```solidity
	    function aggregate3(Call3[] calldata calls) public payable returns (Result[] memory returnData) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 129](src/DKIM/contracts/Multicall3.sol#L129)

	```solidity
	    function aggregate3Value(Call3Value[] calldata calls) public payable returns (Result[] memory returnData) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 165](src/DKIM/contracts/Multicall3.sol#L165)

	```solidity
	    function getBlockHash(uint256 blockNumber) public view returns (bytes32 blockHash) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 170](src/DKIM/contracts/Multicall3.sol#L170)

	```solidity
	    function getBlockNumber() public view returns (uint256 blockNumber) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 175](src/DKIM/contracts/Multicall3.sol#L175)

	```solidity
	    function getCurrentBlockCoinbase() public view returns (address coinbase) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 180](src/DKIM/contracts/Multicall3.sol#L180)

	```solidity
	    function getCurrentBlockDifficulty() public view returns (uint256 difficulty) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 185](src/DKIM/contracts/Multicall3.sol#L185)

	```solidity
	    function getCurrentBlockGasLimit() public view returns (uint256 gaslimit) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 190](src/DKIM/contracts/Multicall3.sol#L190)

	```solidity
	    function getCurrentBlockTimestamp() public view returns (uint256 timestamp) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 195](src/DKIM/contracts/Multicall3.sol#L195)

	```solidity
	    function getEthBalance(address addr) public view returns (uint256 balance) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 200](src/DKIM/contracts/Multicall3.sol#L200)

	```solidity
	    function getLastBlockHash() public view returns (bytes32 blockHash) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 208](src/DKIM/contracts/Multicall3.sol#L208)

	```solidity
	    function getBasefee() public view returns (uint256 basefee) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 213](src/DKIM/contracts/Multicall3.sol#L213)

	```solidity
	    function getChainId() public view returns (uint256 chainid) {
	```

- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 26](src/DKIM/contracts/PluginRegistry.sol#L26)

	```solidity
	    function delegateCall(bytes memory payload)
	```

- Found in src/DKIM/contracts/PublicKeyOracle.sol [Line: 24](src/DKIM/contracts/PublicKeyOracle.sol#L24)

	```solidity
	    function getRSAKey(string memory domain, string memory selector) public view returns (bytes memory modulus, bytes memory exponent) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 45](src/DKIM/contracts/SocialRecovery.sol#L45)

	```solidity
	    function verify(
	```

- Found in src/Wallet.sol [Line: 65](src/wallet.sol#L65)

	```solidity
	    function intToBytes32(uint256 x) public pure returns (bytes32 result) {
	```

- Found in src/Wallet.sol [Line: 84](src/wallet.sol#L84)

	```solidity
	    function initialize(
	```

- Found in src/Wallet.sol [Line: 161](src/wallet.sol#L161)

	```solidity
	    function encodeSignatures(
	```

- Found in src/Wallet.sol [Line: 167](src/wallet.sol#L167)

	```solidity
	    function getDeposit() public view returns (uint256) {
	```

- Found in src/Wallet.sol [Line: 171](src/wallet.sol#L171)

	```solidity
	    function getBalance() public view returns (uint256) {
	```

- Found in src/Wallet.sol [Line: 175](src/wallet.sol#L175)

	```solidity
	    function addDeposit() public payable {
	```

- Found in src/Wallet.sol [Line: 227](src/wallet.sol#L227)

	```solidity
	    function getRecoveryBody(
	```

- Found in src/ZKtool.sol [Line: 14](src/ZKtool.sol#L14)

	```solidity
	    function generateCommitments(uint256[] memory values) public view returns (Commitment[] memory) {
	```

- Found in src/ZKtool.sol [Line: 29](src/ZKtool.sol#L29)

	```solidity
	    function verify(uint256[] memory values, Commitment[] memory commitments) public view returns (bool) {
	```

- Found in src/wallet.sol [Line: 65](src/wallet.sol#L65)

	```solidity
	    function intToBytes32(uint256 x) public pure returns (bytes32 result) {
	```

- Found in src/wallet.sol [Line: 84](src/wallet.sol#L84)

	```solidity
	    function initialize(
	```

- Found in src/wallet.sol [Line: 161](src/wallet.sol#L161)

	```solidity
	    function encodeSignatures(
	```

- Found in src/wallet.sol [Line: 167](src/wallet.sol#L167)

	```solidity
	    function getDeposit() public view returns (uint256) {
	```

- Found in src/wallet.sol [Line: 171](src/wallet.sol#L171)

	```solidity
	    function getBalance() public view returns (uint256) {
	```

- Found in src/wallet.sol [Line: 175](src/wallet.sol#L175)

	```solidity
	    function addDeposit() public payable {
	```

- Found in src/wallet.sol [Line: 227](src/wallet.sol#L227)

	```solidity
	    function getRecoveryBody(
	```

</details>



## L-6: Define and use `constant` variables instead of using literals

If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>72 Found Instances</summary>


- Found in src/DKIM/contracts/Algorithm.sol [Line: 27](src/DKIM/contracts/Algorithm.sol#L27)

	```solidity
	        return ok && sha256(data) == readBytes32(result, result.length - 32);
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 37](src/DKIM/contracts/Algorithm.sol#L37)

	```solidity
	        return ok && SHA1.sha1(data) == readBytes20(result, result.length - 20);
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 45](src/DKIM/contracts/Algorithm.sol#L45)

	```solidity
	        uint size = (32 * 3) + base.length + exponent.length + modulus.length;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 78](src/DKIM/contracts/Algorithm.sol#L78)

	```solidity
	        require(idx + 32 <= self.length);
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 91](src/DKIM/contracts/Algorithm.sol#L91)

	```solidity
	        require(idx + 20 <= self.length);
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 100](src/DKIM/contracts/Algorithm.sol#L100)

	```solidity
	        require(length % 4 == 0, "Invalid base64 string length");
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 102](src/DKIM/contracts/Algorithm.sol#L102)

	```solidity
	        uint256 decodedLength = (length / 4) * 3;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 117](src/DKIM/contracts/Algorithm.sol#L117)

	```solidity
	            for (uint256 i = 0; i < 4; i++) {
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 119](src/DKIM/contracts/Algorithm.sol#L119)

	```solidity
	                if (uint8(data[dataIndex]) >= 65 && uint8(data[dataIndex]) <= 90) {
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 120](src/DKIM/contracts/Algorithm.sol#L120)

	```solidity
	                    chunk |= uint256(uint8(data[dataIndex])) - 65;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 124](src/DKIM/contracts/Algorithm.sol#L124)

	```solidity
	                    chunk |= uint256(uint8(data[dataIndex])) + 4;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 137](src/DKIM/contracts/Algorithm.sol#L137)

	```solidity
	            for (uint256 i = 0; i < 3; i++) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 353](src/DKIM/contracts/SocialRecovery.sol#L353)

	```solidity
	            if (c >= 48 && c <= 57) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 354](src/DKIM/contracts/SocialRecovery.sol#L354)

	```solidity
	                result = result * 10 + (c - 48);
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 392](src/DKIM/contracts/SocialRecovery.sol#L392)

	```solidity
	        for (; len >= 32; len -= 32) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 396](src/DKIM/contracts/SocialRecovery.sol#L396)

	```solidity
	            dest += 32;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 397](src/DKIM/contracts/SocialRecovery.sol#L397)

	```solidity
	            src += 32;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 401](src/DKIM/contracts/SocialRecovery.sol#L401)

	```solidity
	        uint mask = 256 ** (32 - len) - 1;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 48](src/DKIM/contracts/utils/Strings.sol#L48)

	```solidity
	        for(; len1 >= 32; len1 -= 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 52](src/DKIM/contracts/utils/Strings.sol#L52)

	```solidity
	            dest += 32;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 53](src/DKIM/contracts/utils/Strings.sol#L53)

	```solidity
	            src += 32;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 57](src/DKIM/contracts/utils/Strings.sol#L57)

	```solidity
	        uint mask = 256 ** (32 - len1) - 1;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 92](src/DKIM/contracts/utils/Strings.sol#L92)

	```solidity
	            ret += 8;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 96](src/DKIM/contracts/utils/Strings.sol#L96)

	```solidity
	            ret += 4;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 106](src/DKIM/contracts/utils/Strings.sol#L106)

	```solidity
	        return 32 - ret;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 165](src/DKIM/contracts/utils/Strings.sol#L165)

	```solidity
	            if (b < 0x80) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 167](src/DKIM/contracts/utils/Strings.sol#L167)

	```solidity
	            } else if(b < 0xE0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 169](src/DKIM/contracts/utils/Strings.sol#L169)

	```solidity
	            } else if(b < 0xF0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 170](src/DKIM/contracts/utils/Strings.sol#L170)

	```solidity
	                ptr += 3;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 172](src/DKIM/contracts/utils/Strings.sol#L172)

	```solidity
	                ptr += 4;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 206](src/DKIM/contracts/utils/Strings.sol#L206)

	```solidity
	        for (uint idx = 0; idx < shortest; idx += 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 216](src/DKIM/contracts/utils/Strings.sol#L216)

	```solidity
	                if(shortest < 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 217](src/DKIM/contracts/utils/Strings.sol#L217)

	```solidity
	                  mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 225](src/DKIM/contracts/utils/Strings.sol#L225)

	```solidity
	            selfptr += 32;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 226](src/DKIM/contracts/utils/Strings.sol#L226)

	```solidity
	            otherptr += 32;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 260](src/DKIM/contracts/utils/Strings.sol#L260)

	```solidity
	        if (b < 0x80) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 262](src/DKIM/contracts/utils/Strings.sol#L262)

	```solidity
	        } else if(b < 0xE0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 264](src/DKIM/contracts/utils/Strings.sol#L264)

	```solidity
	        } else if(b < 0xF0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 265](src/DKIM/contracts/utils/Strings.sol#L265)

	```solidity
	            l = 3;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 267](src/DKIM/contracts/utils/Strings.sol#L267)

	```solidity
	            l = 4;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 311](src/DKIM/contracts/utils/Strings.sol#L311)

	```solidity
	        if (b < 0x80) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 314](src/DKIM/contracts/utils/Strings.sol#L314)

	```solidity
	        } else if(b < 0xE0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 317](src/DKIM/contracts/utils/Strings.sol#L317)

	```solidity
	        } else if(b < 0xF0) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 319](src/DKIM/contracts/utils/Strings.sol#L319)

	```solidity
	            length = 3;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 322](src/DKIM/contracts/utils/Strings.sol#L322)

	```solidity
	            length = 4;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 331](src/DKIM/contracts/utils/Strings.sol#L331)

	```solidity
	            divisor = divisor / 256;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 333](src/DKIM/contracts/utils/Strings.sol#L333)

	```solidity
	            if (b & 0xC0 != 0x80) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 472](src/DKIM/contracts/utils/Strings.sol#L472)

	```solidity
	            if (needlelen <= 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 473](src/DKIM/contracts/utils/Strings.sol#L473)

	```solidity
	                bytes32 mask = bytes32(~(2 ** (8 * (32 - needlelen)) - 1));
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 512](src/DKIM/contracts/utils/Strings.sol#L512)

	```solidity
	            if (needlelen <= 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 513](src/DKIM/contracts/utils/Strings.sol#L513)

	```solidity
	                bytes32 mask = bytes32(~(2 ** (8 * (32 - needlelen)) - 1));
	```

- Found in src/Wallet.sol [Line: 260](src/wallet.sol#L260)

	```solidity
	        if (v < 27) {
	```

- Found in src/Wallet.sol [Line: 261](src/wallet.sol#L261)

	```solidity
	            v += 27;
	```

- Found in src/Wallet.sol [Line: 263](src/wallet.sol#L263)

	```solidity
	        require(v == 27 || v == 28, "ECDSA signature incorrect");
	```

- Found in src/ZKtool.sol [Line: 58](src/ZKtool.sol#L58)

	```solidity
	            temp /= 10;
	```

- Found in src/ZKtool.sol [Line: 63](src/ZKtool.sol#L63)

	```solidity
	            buffer[digits] = bytes1(uint8(48 + uint8(_value % 10)));
	```

- Found in src/ZKtool.sol [Line: 64](src/ZKtool.sol#L64)

	```solidity
	            _value /= 10;
	```

- Found in src/ZKtool.sol [Line: 75](src/ZKtool.sol#L75)

	```solidity
	            if (c >= 48 && c <= 57) {
	```

- Found in src/ZKtool.sol [Line: 76](src/ZKtool.sol#L76)

	```solidity
	                result = result * 10 + (c - 48);
	```

- Found in src/wallet.sol [Line: 260](src/wallet.sol#L260)

	```solidity
	        if (v < 27) {
	```

- Found in src/wallet.sol [Line: 261](src/wallet.sol#L261)

	```solidity
	            v += 27;
	```

- Found in src/wallet.sol [Line: 263](src/wallet.sol#L263)

	```solidity
	        require(v == 27 || v == 28, "ECDSA signature incorrect");
	```

</details>



## L-7: Empty `require()` / `revert()` statements

Use descriptive reason strings or custom errors for revert paths.

<details><summary>2 Found Instances</summary>


- Found in src/DKIM/contracts/Algorithm.sol [Line: 78](src/DKIM/contracts/Algorithm.sol#L78)

	```solidity
	        require(idx + 32 <= self.length);
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 91](src/DKIM/contracts/Algorithm.sol#L91)

	```solidity
	        require(idx + 20 <= self.length);
	```

</details>



## L-8: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>15 Found Instances</summary>


- Found in src/Counter.sol [Line: 2](src/Counter.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 2](src/DKIM/contracts/Algorithm.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/InitialInterfaces.sol [Line: 2](src/DKIM/contracts/InitialInterfaces.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 2](src/DKIM/contracts/Multicall3.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 2](src/DKIM/contracts/PluginRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/PublicKeyOracle.sol [Line: 2](src/DKIM/contracts/PublicKeyOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 2](src/DKIM/contracts/SocialRecovery.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/DKIM/contracts/interfaces/IDKIMPublicKeyOracle.sol [Line: 2](src/DKIM/contracts/interfaces/IDKIMPublicKeyOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/interfaces/ISocialRecovery.sol [Line: 2](src/DKIM/contracts/interfaces/ISocialRecovery.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 38](src/DKIM/contracts/utils/Strings.sol#L38)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in src/EntryPoint.sol [Line: 2](src/EntryPoint.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/Wallet.sol [Line: 2](src/wallet.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/ZKtool.sol [Line: 2](src/ZKtool.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/wallet.sol [Line: 2](src/wallet.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/walletFactory.sol [Line: 2](src/walletFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

</details>



## L-9: Modifiers invoked only once can be shoe-horned into the function



<details><summary>2 Found Instances</summary>


- Found in src/Wallet.sol [Line: 49](src/wallet.sol#L49)

	```solidity
	    modifier checkNonce(uint256 _nonce) {
	```

- Found in src/wallet.sol [Line: 49](src/wallet.sol#L49)

	```solidity
	    modifier checkNonce(uint256 _nonce) {
	```

</details>



## L-10: Empty Block

Consider removing empty blocks.

<details><summary>1 Found Instances</summary>


- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 213](src/DKIM/contracts/SocialRecovery.sol#L213)

	```solidity
	    function parseSigTags(
	```

</details>



## L-11: Internal functions called only once can be inlined

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>11 Found Instances</summary>


- Found in src/DKIM/contracts/PluginRegistry.sol [Line: 37](src/DKIM/contracts/PluginRegistry.sol#L37)

	```solidity
	    function getMethodId(bytes memory data)
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 125](src/DKIM/contracts/SocialRecovery.sol#L125)

	```solidity
	    function verifyBodyHash(
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 149](src/DKIM/contracts/SocialRecovery.sol#L149)

	```solidity
	    function verifySignature(
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 180](src/DKIM/contracts/SocialRecovery.sol#L180)

	```solidity
	    function parse(
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 213](src/DKIM/contracts/SocialRecovery.sol#L213)

	```solidity
	    function parseSigTags(
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 289](src/DKIM/contracts/SocialRecovery.sol#L289)

	```solidity
	    function parseSigHTag(
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 83](src/DKIM/contracts/utils/Strings.sol#L83)

	```solidity
	    function len(bytes32 self) internal pure returns (uint) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 199](src/DKIM/contracts/utils/Strings.sol#L199)

	```solidity
	    function compare(slice memory self, slice memory other) internal pure returns (int) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 248](src/DKIM/contracts/utils/Strings.sol#L248)

	```solidity
	    function nextRune(slice memory self, slice memory rune) internal pure returns (slice memory) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 585](src/DKIM/contracts/utils/Strings.sol#L585)

	```solidity
	    function split(slice memory self, slice memory needle, slice memory token) internal pure returns (slice memory) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 622](src/DKIM/contracts/utils/Strings.sol#L622)

	```solidity
	    function rsplit(slice memory self, slice memory needle, slice memory token) internal pure returns (slice memory) {
	```

</details>



## L-12: Inconsistency in declaring uint256/uint (or) int256/int variables within a contract. Use explicit size declarations (uint256 or int256).

Consider keeping the naming convention consistent in a given contract. Explicit size declarations are preferred (uint256, int256) over implicit ones (uint, int) to avoid confusion.

<details><summary>80 Found Instances</summary>


- Found in src/DKIM/contracts/Algorithm.sol [Line: 45](src/DKIM/contracts/Algorithm.sol#L45)

	```solidity
	        uint size = (32 * 3) + base.length + exponent.length + modulus.length;
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 70](src/DKIM/contracts/Algorithm.sol#L70)

	```solidity
	    function readBytes32(bytes memory self, uint idx) internal pure returns (bytes32 ret) {
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 90](src/DKIM/contracts/Algorithm.sol#L90)

	```solidity
	    function readBytes20(bytes memory self, uint idx) internal pure returns (bytes20 ret) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 32](src/DKIM/contracts/SocialRecovery.sol#L32)

	```solidity
	        uint l;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 49](src/DKIM/contracts/SocialRecovery.sol#L49)

	```solidity
	        uint recoveryNonce,
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 88](src/DKIM/contracts/SocialRecovery.sol#L88)

	```solidity
	        uint recoveryNonce,
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 299](src/DKIM/contracts/SocialRecovery.sol#L299)

	```solidity
	        for (uint i = 0; i < list.length; i++) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 301](src/DKIM/contracts/SocialRecovery.sol#L301)

	```solidity
	            uint j = 0;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 337](src/DKIM/contracts/SocialRecovery.sol#L337)

	```solidity
	        uint count = value.count(crlf);
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 340](src/DKIM/contracts/SocialRecovery.sol#L340)

	```solidity
	        for (uint i = 0; i < parts.length; i++) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 347](src/DKIM/contracts/SocialRecovery.sol#L347)

	```solidity
	    function stringToUint(string memory s) internal pure returns (uint result) {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 349](src/DKIM/contracts/SocialRecovery.sol#L349)

	```solidity
	        uint i;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 352](src/DKIM/contracts/SocialRecovery.sol#L352)

	```solidity
	            uint c = uint8(b[i]);
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 364](src/DKIM/contracts/SocialRecovery.sol#L364)

	```solidity
	        uint length = 0;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 365](src/DKIM/contracts/SocialRecovery.sol#L365)

	```solidity
	        uint i;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 373](src/DKIM/contracts/SocialRecovery.sol#L373)

	```solidity
	        uint retptr;
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 391](src/DKIM/contracts/SocialRecovery.sol#L391)

	```solidity
	    function memcpy(uint dest, uint src, uint len) private pure {
	```

- Found in src/DKIM/contracts/SocialRecovery.sol [Line: 401](src/DKIM/contracts/SocialRecovery.sol#L401)

	```solidity
	        uint mask = 256 ** (32 - len) - 1;
	```

- Found in src/DKIM/contracts/interfaces/ISocialRecovery.sol [Line: 9](src/DKIM/contracts/interfaces/ISocialRecovery.sol#L9)

	```solidity
	        uint recoveryNonce,
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 42](src/DKIM/contracts/utils/Strings.sol#L42)

	```solidity
	        uint _len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 43](src/DKIM/contracts/utils/Strings.sol#L43)

	```solidity
	        uint _ptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 46](src/DKIM/contracts/utils/Strings.sol#L46)

	```solidity
	    function memcpy(uint dest, uint src, uint len1) private pure {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 57](src/DKIM/contracts/utils/Strings.sol#L57)

	```solidity
	        uint mask = 256 ** (32 - len1) - 1;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 71](src/DKIM/contracts/utils/Strings.sol#L71)

	```solidity
	        uint ptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 83](src/DKIM/contracts/utils/Strings.sol#L83)

	```solidity
	    function len(bytes32 self) internal pure returns (uint) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 84](src/DKIM/contracts/utils/Strings.sol#L84)

	```solidity
	        uint ret;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 143](src/DKIM/contracts/utils/Strings.sol#L143)

	```solidity
	        uint retptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 158](src/DKIM/contracts/utils/Strings.sol#L158)

	```solidity
	    function len(slice memory self) internal pure returns (uint l) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 160](src/DKIM/contracts/utils/Strings.sol#L160)

	```solidity
	        uint ptr = self._ptr - 31;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 161](src/DKIM/contracts/utils/Strings.sol#L161)

	```solidity
	        uint end = ptr + self._len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 200](src/DKIM/contracts/utils/Strings.sol#L200)

	```solidity
	        uint shortest = self._len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 204](src/DKIM/contracts/utils/Strings.sol#L204)

	```solidity
	        uint selfptr = self._ptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 205](src/DKIM/contracts/utils/Strings.sol#L205)

	```solidity
	        uint otherptr = other._ptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 206](src/DKIM/contracts/utils/Strings.sol#L206)

	```solidity
	        for (uint idx = 0; idx < shortest; idx += 32) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 207](src/DKIM/contracts/utils/Strings.sol#L207)

	```solidity
	            uint a;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 208](src/DKIM/contracts/utils/Strings.sol#L208)

	```solidity
	            uint b;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 256](src/DKIM/contracts/utils/Strings.sol#L256)

	```solidity
	        uint l;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 257](src/DKIM/contracts/utils/Strings.sol#L257)

	```solidity
	        uint b;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 299](src/DKIM/contracts/utils/Strings.sol#L299)

	```solidity
	    function ord(slice memory self) internal pure returns (uint ret) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 304](src/DKIM/contracts/utils/Strings.sol#L304)

	```solidity
	        uint word;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 305](src/DKIM/contracts/utils/Strings.sol#L305)

	```solidity
	        uint length;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 306](src/DKIM/contracts/utils/Strings.sol#L306)

	```solidity
	        uint divisor = 2 ** 248;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 310](src/DKIM/contracts/utils/Strings.sol#L310)

	```solidity
	        uint b = word / divisor;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 330](src/DKIM/contracts/utils/Strings.sol#L330)

	```solidity
	        for (uint i = 1; i < length; i++) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 420](src/DKIM/contracts/utils/Strings.sol#L420)

	```solidity
	        uint selfptr = self._ptr + self._len - needle._len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 448](src/DKIM/contracts/utils/Strings.sol#L448)

	```solidity
	        uint selfptr = self._ptr + self._len - needle._len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 467](src/DKIM/contracts/utils/Strings.sol#L467)

	```solidity
	    function findPtr(uint selflen, uint selfptr, uint needlelen, uint needleptr) private pure returns (uint) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 468](src/DKIM/contracts/utils/Strings.sol#L468)

	```solidity
	        uint ptr = selfptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 469](src/DKIM/contracts/utils/Strings.sol#L469)

	```solidity
	        uint idx;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 478](src/DKIM/contracts/utils/Strings.sol#L478)

	```solidity
	                uint end = selfptr + selflen - needlelen;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 508](src/DKIM/contracts/utils/Strings.sol#L508)

	```solidity
	    function rfindPtr(uint selflen, uint selfptr, uint needlelen, uint needleptr) private pure returns (uint) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 509](src/DKIM/contracts/utils/Strings.sol#L509)

	```solidity
	        uint ptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 555](src/DKIM/contracts/utils/Strings.sol#L555)

	```solidity
	        uint ptr = findPtr(self._len, self._ptr, needle._len, needle._ptr);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 570](src/DKIM/contracts/utils/Strings.sol#L570)

	```solidity
	        uint ptr = rfindPtr(self._len, self._ptr, needle._len, needle._ptr);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 586](src/DKIM/contracts/utils/Strings.sol#L586)

	```solidity
	        uint ptr = findPtr(self._len, self._ptr, needle._len, needle._ptr);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 623](src/DKIM/contracts/utils/Strings.sol#L623)

	```solidity
	        uint ptr = rfindPtr(self._len, self._ptr, needle._len, needle._ptr);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 654](src/DKIM/contracts/utils/Strings.sol#L654)

	```solidity
	    function count(slice memory self, slice memory needle) internal pure returns (uint cnt) {
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 655](src/DKIM/contracts/utils/Strings.sol#L655)

	```solidity
	        uint ptr = findPtr(self._len, self._ptr, needle._len, needle._ptr) + needle._len;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 681](src/DKIM/contracts/utils/Strings.sol#L681)

	```solidity
	        uint retptr;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 700](src/DKIM/contracts/utils/Strings.sol#L700)

	```solidity
	        uint length = self._len * (parts.length - 1);
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 701](src/DKIM/contracts/utils/Strings.sol#L701)

	```solidity
	        uint i;
	```

- Found in src/DKIM/contracts/utils/Strings.sol [Line: 706](src/DKIM/contracts/utils/Strings.sol#L706)

	```solidity
	        uint retptr;
	```

- Found in src/Wallet.sol [Line: 30](src/wallet.sol#L30)

	```solidity
	    uint public nonce;
	```

- Found in src/Wallet.sol [Line: 31](src/wallet.sol#L31)

	```solidity
	    uint public recoveryNonce;
	```

- Found in src/Wallet.sol [Line: 238](src/wallet.sol#L238)

	```solidity
	        returns (bytes memory owner, bytes memory contractaddr, uint _nonce)
	```

- Found in src/wallet.sol [Line: 30](src/wallet.sol#L30)

	```solidity
	    uint public nonce;
	```

- Found in src/wallet.sol [Line: 31](src/wallet.sol#L31)

	```solidity
	    uint public recoveryNonce;
	```

- Found in src/wallet.sol [Line: 238](src/wallet.sol#L238)

	```solidity
	        returns (bytes memory owner, bytes memory contractaddr, uint _nonce)
	```

</details>



## L-13: Loop contains `require`/`revert` statements

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>4 Found Instances</summary>


- Found in src/DKIM/contracts/Algorithm.sol [Line: 115](src/DKIM/contracts/Algorithm.sol#L115)

	```solidity
	        while (dataIndex < length) {
	```

- Found in src/DKIM/contracts/Algorithm.sol [Line: 117](src/DKIM/contracts/Algorithm.sol#L117)

	```solidity
	            for (uint256 i = 0; i < 4; i++) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 46](src/DKIM/contracts/Multicall3.sol#L46)

	```solidity
	        for (uint256 i = 0; i < length;) {
	```

- Found in src/DKIM/contracts/Multicall3.sol [Line: 64](src/DKIM/contracts/Multicall3.sol#L64)

	```solidity
	        for (uint256 i = 0; i < length;) {
	```

</details>



